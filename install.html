
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Appendix A: Getting Started: Installing LLVM and the Cpu0 example code &#8212; Tutorial: Creating an LLVM Backend for the Cpu0 Architecture</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/haiku.css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Appendix B: Cpu0 document and test" href="doc.html" />
    <link rel="prev" title="Verify backend on Verilog simulator" href="verilog.html" /> 
  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="index.html">
          <span>Tutorial: Creating an LLVM Backend for the Cpu0 Architecture</span></a></h1>
        <h2 class="heading"><span>Appendix A: Getting Started: Installing LLVM and the Cpu0 example code</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="verilog.html">Verify backend on Verilog simulator</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="doc.html">Appendix B: Cpu0 document and test</a>&#160;&#160;»
        </p>

      </div>
      <div class="content" role="main">
        
        
  <section id="appendix-a-getting-started-installing-llvm-and-the-cpu0-example-code">
<span id="sec-appendix-installing"></span><h1>Appendix A: Getting Started: Installing LLVM and the Cpu0 example code<a class="headerlink" href="#appendix-a-getting-started-installing-llvm-and-the-cpu0-example-code" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#build-steps" id="id10">Build steps</a></p></li>
<li><p><a class="reference internal" href="#setting-up-your-mac" id="id11">Setting Up Your Mac</a></p>
<ul>
<li><p><a class="reference internal" href="#install-icarus-verilog-tool-on-imac" id="id12">Install Icarus Verilog tool on iMac</a></p></li>
<li><p><a class="reference internal" href="#install-other-tools-on-imac" id="id13">Install other tools on iMac</a></p></li>
<li><p><a class="reference internal" href="#setup-path" id="id14">Setup path</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#setting-up-your-linux-machine" id="id15">Setting Up Your Linux Machine</a></p>
<ul>
<li><p><a class="reference internal" href="#install-icarus-verilog-tool-on-linux" id="id16">Install Icarus Verilog tool on Linux</a></p></li>
<li><p><a class="reference internal" href="#install-other-tools-on-linux" id="id17">Install other tools on Linux</a></p></li>
</ul>
</li>
</ul>
</div>
<p>Cpu0 example code, lbdex, can be found at near left bottom of this web site. Or
here <a class="reference external" href="http://jonathan2251.github.io/lbd/lbdex.tar.gz">http://jonathan2251.github.io/lbd/lbdex.tar.gz</a>.</p>
<p>In this chapter, we will run through how to set up LLVM using if you are using
Mac OS X or Linux.
For information on using <code class="docutils literal notranslate"><span class="pre">cmake</span></code> to build LLVM, please refer to the “Building
LLVM with CMake” <a class="footnote-reference brackets" href="#llvm-cmake" id="id1">1</a> documentation for further information.</p>
<p>We will install two llvm directories in this chapter. One is the directory
~/llvm/release/ which contains the clang and clang++ compiler we will use to
translate the C/C++ input file into llvm IR.
The other is the directory ~/llvm/test/ which contains our cpu0 backend
program and clang.</p>
<section id="build-steps">
<h2><a class="toc-backref" href="#id10">Build steps</a><a class="headerlink" href="#build-steps" title="Permalink to this headline">¶</a></h2>
<p>After setup brew install for iMac or install necessory packages. Build as
<a class="reference external" href="https://github.com/Jonathan2251/lbd/blob/master/README.md">https://github.com/Jonathan2251/lbd/blob/master/README.md</a>.</p>
</section>
<section id="setting-up-your-mac">
<h2><a class="toc-backref" href="#id11">Setting Up Your Mac</a><a class="headerlink" href="#setting-up-your-mac" title="Permalink to this headline">¶</a></h2>
<p>Brew install and setup first.</p>
<section id="install-icarus-verilog-tool-on-imac">
<h3><a class="toc-backref" href="#id12">Install Icarus Verilog tool on iMac</a><a class="headerlink" href="#install-icarus-verilog-tool-on-imac" title="Permalink to this headline">¶</a></h3>
<p>Install Icarus Verilog tool by command <code class="docutils literal notranslate"><span class="pre">brew</span> <span class="pre">install</span> <span class="pre">icarus-verilog</span></code> as follows,</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">JonathantekiiMac:~ Jonathan$ </span>brew install icarus-verilog
<span class="go">==&gt; Downloading ftp://icarus.com/pub/eda/verilog/v0.9/verilog-0.9.5.tar.gz</span>
<span class="gp">#</span><span class="c1">####################################################################### 100.0%</span>
<span class="gp">#</span><span class="c1">####################################################################### 100.0%</span>
<span class="go">==&gt; ./configure --prefix=/usr/local/Cellar/icarus-verilog/0.9.5</span>
<span class="go">==&gt; make</span>
<span class="go">==&gt; make installdirs</span>
<span class="go">==&gt; make install</span>
<span class="go">/usr/local/Cellar/icarus-verilog/0.9.5: 39 files, 12M, built in 55 seconds</span>
</pre></div>
</div>
</section>
<section id="install-other-tools-on-imac">
<h3><a class="toc-backref" href="#id13">Install other tools on iMac</a><a class="headerlink" href="#install-other-tools-on-imac" title="Permalink to this headline">¶</a></h3>
<p>Download tool Graphviz for display llvm IR nodes in debugging,
<a class="footnote-reference brackets" href="#graphviz-dm" id="id2">8</a>.
We choose mountainlion as <a class="reference internal" href="#install-f13"><span class="std std-numref">Fig. 30</span></a> since our iMac is Mountain
Lion.</p>
<figure class="align-center" id="id7">
<span id="install-f13"></span><a class="reference internal image-reference" href="_images/131.png"><img alt="_images/131.png" src="_images/131.png" style="width: 944.8000000000001px; height: 590.4px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 30 </span><span class="caption-text">Download graphviz for llvm IR node display</span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>After install Graphviz, please set the path to .profile.
For example, we install the Graphviz in directory
/Applications/Graphviz.app/Contents/MacOS/, so add this path to
/User/Jonathan/.profile as follows,</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">118-165-12-177:input Jonathan$ </span>cat /Users/Jonathan/.profile
<span class="go">export PATH=$PATH:/Applications/Xcode.app/Contents/bin:</span>
<span class="go">/Applications/Graphviz.app/Contents/MacOS/:/Users/Jonathan/llvm/release/</span>
<span class="go">build/bin</span>
</pre></div>
</div>
<p>The Graphviz information for llvm is at section “SelectionDAG Instruction
Selection Process” ” of “The LLVM Target-Independent Code Generator” here
<a class="footnote-reference brackets" href="#isp" id="id3">9</a>  and at section “Viewing graphs while debugging code” of “LLVM
Programmer’s Manual” here <a class="footnote-reference brackets" href="#vgwdc" id="id4">10</a>.
TextWrangler is for edit file with line number display and dump binary file
like the obj file, *.o, that will be generated in chapter of Generating object
files if you havn’t gobjdump available.
You can download from App Store.
To dump binary file, first, open the binary file, next, select menu
<strong>“File – Hex Front Document”</strong> as <a class="reference internal" href="#install-f14"><span class="std std-numref">Fig. 31</span></a>.
Then select <strong>“Front document’s file”</strong> as <a class="reference internal" href="#install-f15"><span class="std std-numref">Fig. 32</span></a>.</p>
<figure class="align-center" id="id8">
<span id="install-f14"></span><img alt="_images/14.png" src="_images/14.png" />
<figcaption>
<p><span class="caption-number">Fig. 31 </span><span class="caption-text">Select Hex Dump menu</span><a class="headerlink" href="#id8" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id9">
<span id="install-f15"></span><img alt="_images/15.png" src="_images/15.png" />
<figcaption>
<p><span class="caption-number">Fig. 32 </span><span class="caption-text">Select Front document’s file in TextWrangler</span><a class="headerlink" href="#id9" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>Install binutils by command <code class="docutils literal notranslate"><span class="pre">brew</span> <span class="pre">install</span> <span class="pre">binutils</span></code> as follows,</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">// get brew by the following ruby command if you don&#39;t have installed brew</span>
<span class="gp">118-165-77-214:~ Jonathan$ </span>ruby -e <span class="s2">&quot;</span><span class="k">$(</span>curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install<span class="k">)</span><span class="s2">&quot;</span> &lt; /dev/null <span class="m">2</span>&gt; /dev/null
<span class="gp">118-165-77-214:~ Jonathan$ </span>brew install binutils
<span class="go">==&gt; Downloading http://ftpmirror.gnu.org/binutils/binutils-2.22.tar.gz</span>
<span class="gp">#</span><span class="c1">####################################################################### 100.0%</span>
<span class="go">==&gt; ./configure --program-prefix=g --prefix=/usr/local/Cellar/binutils/2.22</span>
<span class="go">--infodir=/usr/loca</span>
<span class="go">==&gt; make</span>
<span class="go">==&gt; make install</span>
<span class="go">/usr/local/Cellar/binutils/2.22: 90 files, 19M, built in 4.7 minutes</span>
<span class="gp">118-165-77-214:~ Jonathan$ </span>ls /usr/local/Cellar/binutils/2.22
<span class="go">COPYING     README      lib</span>
<span class="go">ChangeLog     bin       share</span>
<span class="go">INSTALL_RECEIPT.json    include       x86_64-apple-darwin12.2.0</span>
<span class="gp">118-165-77-214:binutils-2.23 Jonathan$ </span>ls /usr/local/Cellar/binutils/2.22/bin
<span class="go">gaddr2line  gc++filt  gnm   gobjdump  greadelf  gstrings</span>
<span class="go">gar   gelfedit  gobjcopy  granlib gsize   gstrip</span>
</pre></div>
</div>
</section>
<section id="setup-path">
<h3><a class="toc-backref" href="#id14">Setup path</a><a class="headerlink" href="#setup-path" title="Permalink to this headline">¶</a></h3>
<p>To access those execution files, edit .profile (if you .profile not exists,
please create file .profile), save .profile to /Users/Jonathan/, and enable
$PATH by command <code class="docutils literal notranslate"><span class="pre">source</span> <span class="pre">.profile</span></code> as follows.
Please add path /Applications//Xcode.app/Contents/Developer/usr/bin to .profile
if you didn’t add it after Xcode download.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">118-165-65-128:~ Jonathan$ </span><span class="nb">pwd</span>
<span class="go">/Users/Jonathan</span>
<span class="gp">118-165-65-128:~ Jonathan$ </span>cat .profile
<span class="go">export PATH=$PATH:/Applications/Xcode.app/Contents/Developer/usr/bin:/Applicatio</span>
<span class="go">ns/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/:/Ap</span>
<span class="go">plications/Graphviz.app/Contents/MacOS/:/Users/Jonathan/llvm/release/build/bin</span>
<span class="go">export WORKON_HOME=$HOME/.virtualenvs</span>
<span class="go">source /usr/local/bin/virtualenvwrapper.sh # where Homebrew places it</span>
<span class="go">export VIRTUALENVWRAPPER_VIRTUALENV_ARGS=&#39;--no-site-packages&#39; # optional</span>
<span class="gp">118-165-65-128:~ Jonathan$</span>
</pre></div>
</div>
</section>
</section>
<section id="setting-up-your-linux-machine">
<h2><a class="toc-backref" href="#id15">Setting Up Your Linux Machine</a><a class="headerlink" href="#setting-up-your-linux-machine" title="Permalink to this headline">¶</a></h2>
<section id="install-icarus-verilog-tool-on-linux">
<h3><a class="toc-backref" href="#id16">Install Icarus Verilog tool on Linux</a><a class="headerlink" href="#install-icarus-verilog-tool-on-linux" title="Permalink to this headline">¶</a></h3>
<p>Download the snapshot version of Icarus Verilog tool from web site,
<a class="reference external" href="ftp://icarus.com/pub/eda/verilog/snapshots">ftp://icarus.com/pub/eda/verilog/snapshots</a> or go to <a class="reference external" href="http://iverilog.icarus.com/">http://iverilog.icarus.com/</a>
and click snapshot version link. Follow the INSTALL file guide to install it.</p>
</section>
<section id="install-other-tools-on-linux">
<h3><a class="toc-backref" href="#id17">Install other tools on Linux</a><a class="headerlink" href="#install-other-tools-on-linux" title="Permalink to this headline">¶</a></h3>
<p>Download Graphviz from <a class="footnote-reference brackets" href="#graphviz-download" id="id5">11</a> according your
Linux distribution. Files compare tools Kdiff3 came from web site <a class="footnote-reference brackets" href="#kdiff3" id="id6">7</a>.</p>
<p>Set /home/Gamma/.bash_profile as follows,</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">[Gamma@localhost ~]$ </span><span class="nb">pwd</span>
<span class="go">/home/Gamma</span>
<span class="gp">[Gamma@localhost ~]$ </span>cat .bash_profile
<span class="gp"># </span>.bash_profile

<span class="gp"># </span>Get the aliases and functions
<span class="go">if [ -f ~/.bashrc ]; then</span>
<span class="go">  . ~/.bashrc</span>
<span class="go">fi</span>

<span class="gp"># </span>User specific environment and startup programs

<span class="go">PATH=$PATH:/usr/local/sphinx/bin:~/llvm/release/build/bin:</span>
<span class="go">...</span>
<span class="go">export PATH</span>
<span class="gp">[Gamma@localhost ~]$ </span><span class="nb">source</span> .bash_profile
<span class="gp">[Gamma@localhost ~]$ </span><span class="nv">$PATH</span>
<span class="go">bash: /usr/lib64/qt-3.3/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/sbin:</span>
<span class="go">/usr/sbin:/usr/local/sphinx/bin:/home/Gamma/.local/bin:/home/Gamma/bin:</span>
<span class="go">/usr/local/sphinx/bin:/home/cschen/llvm/release/build/bin</span>
</pre></div>
</div>
<dl class="footnote brackets">
<dt class="label" id="llvm-cmake"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p><a class="reference external" href="http://llvm.org/docs/CMake.html?highlight=cmake">http://llvm.org/docs/CMake.html?highlight=cmake</a></p>
</dd>
<dt class="label" id="llvm-download"><span class="brackets">2</span></dt>
<dd><p><a class="reference external" href="http://llvm.org/releases/download.html#3.9">http://llvm.org/releases/download.html#3.9</a></p>
</dd>
<dt class="label" id="cmake"><span class="brackets">3</span></dt>
<dd><p><a class="reference external" href="http://www.cmake.org/cmake/resources/software.html">http://www.cmake.org/cmake/resources/software.html</a></p>
</dd>
<dt class="label" id="lldb-gdb"><span class="brackets">4</span></dt>
<dd><p><a class="reference external" href="http://lldb.llvm.org/lldb-gdb.html">http://lldb.llvm.org/lldb-gdb.html</a></p>
</dd>
<dt class="label" id="lldb"><span class="brackets">5</span></dt>
<dd><p><a class="reference external" href="http://lldb.llvm.org/">http://lldb.llvm.org/</a></p>
</dd>
<dt class="label" id="test"><span class="brackets">6</span></dt>
<dd><p><a class="reference external" href="http://llvm.org/docs/TestingGuide.html">http://llvm.org/docs/TestingGuide.html</a></p>
</dd>
<dt class="label" id="kdiff3"><span class="brackets"><a class="fn-backref" href="#id6">7</a></span></dt>
<dd><p><a class="reference external" href="http://kdiff3.sourceforge.net">http://kdiff3.sourceforge.net</a></p>
</dd>
<dt class="label" id="graphviz-dm"><span class="brackets"><a class="fn-backref" href="#id2">8</a></span></dt>
<dd><p><a class="reference external" href="http://www.graphviz.org/Download_macos.php">http://www.graphviz.org/Download_macos.php</a></p>
</dd>
<dt class="label" id="isp"><span class="brackets"><a class="fn-backref" href="#id3">9</a></span></dt>
<dd><p><a class="reference external" href="http://llvm.org/docs/CodeGenerator.html#selectiondag-instruction-selection-process">http://llvm.org/docs/CodeGenerator.html#selectiondag-instruction-selection-process</a></p>
</dd>
<dt class="label" id="vgwdc"><span class="brackets"><a class="fn-backref" href="#id4">10</a></span></dt>
<dd><p><a class="reference external" href="http://llvm.org/docs/ProgrammersManual.html#viewing-graphs-while-debugging-code">http://llvm.org/docs/ProgrammersManual.html#viewing-graphs-while-debugging-code</a></p>
</dd>
<dt class="label" id="graphviz-download"><span class="brackets"><a class="fn-backref" href="#id5">11</a></span></dt>
<dd><p><a class="reference external" href="http://www.graphviz.org/Download.php">http://www.graphviz.org/Download.php</a></p>
</dd>
</dl>
</section>
</section>
</section>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="verilog.html">Verify backend on Verilog simulator</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="doc.html">Appendix B: Cpu0 document and test</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Chen Chung-Shu.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.0.2.
    </div>
  </body>
</html>